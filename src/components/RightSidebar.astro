---
// src/components/RightSidebar.astro
---

<button id="menu-toggle" aria-label="Toggle Menu" class="toggle-btn">
  â˜° Menu
</button>

<div id="menu-overlay" class="overlay"></div>

<nav id="right-sidebar" class="sidebar">
  <button id="menu-close" aria-label="Close Menu" class="close-btn">
    &times;
  </button>
  
  <div class="sidebar-content">
    <h3>Navigation</h3>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/services">Services</a></li>
      <li><a href="/contact">Contact</a></li>
    </ul>
  </div>
</nav>

<style>
  /* 1. The Toggle Button */
  .toggle-btn {
    position: fixed;
    top: 1rem;
    right: 1rem;
    z-index: 40; /* Above regular content but below sidebar */
    padding: 0.5rem 1rem;
    background: #333;
    color: white;
    border: none;
    cursor: pointer;
    border-radius: 4px;
  }

  /* 2. The Sidebar Container */
  .sidebar {
    position: fixed;
    top: 0;
    right: -400px; /* Start hidden off-screen to the right */
    width: 200px;
    height: 100%;
    background: #ffffff;
    box-shadow: -2px 0 5px rgba(0,0,0,0.1);
    z-index: 50; /* Highest priority */
    transition: right 0.3s ease-in-out; /* Smooth slide animation */
    padding: 2rem;
    display: flex;
    flex-direction: column;
  }

  /* Active State for Sidebar */
  .sidebar.open {
    right: 0; /* Slide in */
  }

  /* 3. The Overlay (Darkens the background) */
  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 45;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease-in-out;
  }

  /* Active State for Overlay */
  .overlay.active {
    opacity: 1;
    visibility: visible;
  }

  /* Close Button inside Sidebar */
  .close-btn {
    align-self: flex-end;
    background: transparent;
    border: none;
    font-size: 2rem;
    cursor: pointer;
    margin-bottom: 1rem;
  }

  ul {
    list-style: none;
    padding: 0;
  }

  li {
    margin: 1rem 0;
  }
  
  a {
    text-decoration: none;
    color: #333;
    font-size: 1.2rem;
  }
</style>

<script>
  // Astro runs this script on the client side
  const sidebar = document.getElementById('right-sidebar');
  const toggleBtn = document.getElementById('menu-toggle');
  const closeBtn = document.getElementById('menu-close');
  const overlay = document.getElementById('menu-overlay');

  function toggleMenu() {
    sidebar?.classList.toggle('open');
    overlay?.classList.toggle('active');
    
    // Accessibility: Lock body scroll when menu is open
    document.body.style.overflow = sidebar?.classList.contains('open') ? 'hidden' : '';
  }

  // Event Listeners
  toggleBtn?.addEventListener('click', toggleMenu);
  closeBtn?.addEventListener('click', toggleMenu);
  overlay?.addEventListener('click', toggleMenu); // Close when clicking outside
</script>